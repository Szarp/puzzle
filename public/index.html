<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width,initial-scale=1">
		<meta name="mobile-web-app-capable" content="yes">
		<meta name="theme-color" content="#1e2327">
        <title>Puzzle</title>
        <meta name="description" content="cnc">
		<meta name="keywords" content="cnc">
		<meta name="robots" content="index, follow">
		<meta name="googlebot" content="index, follow">
		<link rel="shortcut icon" href="/favicon.ico">
		<link rel="icon" href="/css/favicon.png" type="image/png">
		<link rel="icon" sizes="1024x1024" href="/img/icon1024.png">
		<link rel="icon" sizes="192x192" href="/img/icon192.png">
		<link rel="icon" sizes="144x144" href="/img/icon144.png">
		<link rel="manifest" href="/manifest.json">
        <link rel="stylesheet" href="css/webPage.css">
         <link rel="stylesheet" href="css/mediaSize.css">
        <link rel="stylesheet" href="css/gCode.css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
        <script type="text/javascript" src="js/sendForm.js"></script>
    </head>
    <style>
        .body {
  -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome and Opera */
}
     #arrays{
            
        }
        #image {
            /*background-color: rebeccapurple;*/
            background-image: url("/public/img/");
            background-repeat: no-repeat;
            background-size: contain;
            width: 500px;
            height: 200px;
        }
        #image svg {
            width: 500px;
            height: 200px;
        }
        #step{
            background-color: transparent;
        }
        #step td{
            color: #111;
            border: 0px solid black;
            font-weight:normal;
            background-color: transparent;
        }
        </style>
<script>
    var ifClicked=0;
    window.addEventListener("mousedown",function(){
        //console.log("ok");
        ifClicked=1;
    })
    window.addEventListener("mouseup",function(){
        //console.log("ok");
        ifClicked=0;
        var x = document.getElementById('image').getElementsByTagName('svg')[0].getElementsByTagName("rect");
            var pos=[[10000,10000],[0,0]];
            //beg=getPosition(x[150]);
        //console.log("elems"+ x.length);
        //console.log(x[1]);
        //console.log(document.getElementById('image').getElementsByTagName('svg')[0]);
        for(var i=0;i<x.length;i++){
            var oneRect = x[i];
            //console.log("R"+oneRect);
            if(oneRect.getAttribute("fill") == "purple"){
                var cords= getPosition(x[i]);
                pos=compare(pos,cords);
            }
            //console.log(x.filter(function(el){compare2(pos,getPosition(el))}));
            //console.log(oneRect.getAttribute("fill"));
        }
        //console.log("pos "+pos)
        //console.log("elems "+ x);
        //console.log(document.getElementById('image').getElementsByTagName('svg')[0]);
        var color=createColor();
        for(var j=0;j<x.length;j++){
            var oneRect = x[j];
                        //console.log("RR",oneRect);
            //if(oneRect.getAttribute("fill") == "purple"){            
                var cords= getPosition(oneRect);
                //console.log(oneRect);
                if(compare2(pos,cords)){
                    if(oneRect.getAttribute("class")=="a"){
                        oneRect.setAttribute("fill",color);
                    }
                    if(oneRect.getAttribute("fill")==color){
                        oneRect.setAttribute("class","b");
                    }
                    //oneRect.setAttribute("class","b");
                    //console.log("hehr",oneRect)
                    
                }
            //}
            //console.log(x.filter(function(el){compare2(pos,getPosition(el))}));
            //console.log(oneRect.getAttribute("fill"));
        }
        //console.log(drawBigRect(pos,""));
        //document.getElementById('image').getElementsByTagName('svg')[0].innerHTML+=drawBigRect(pos,"");
        document.getElementById('image').getElementsByTagName('svg')[0].innerHTML+="";
        //clear(x);
        //console.log(x);
        addEvents("mouseover",x,function(){draw(this);/*console.log(this.getAttribute("class"))*/;});
        var els = document.getElementById('image').getElementsByTagName("rect");
        for(var i=0;i<els.length;i++){
                if(els[i].getAttribute("class")=="b"){
                    els[i].addEventListener("mousedown",fillTransparent);
                    //els[i].setAttribute("fill","transparent");
                }
        }
    })
        function fillTransparent(){
            var time = new Date().getTime();
            var x = this.getAttribute("data-time");
            this.setAttribute("data-time",time);
            if(time-x<500){
                var color = this.getAttribute("fill");
                var els = document.getElementById('image').getElementsByTagName("rect");
                for(var i=0;i<els.length;i++){
                    if(els[i].getAttribute("fill")==color)
                    els[i].setAttribute("fill","transparent");
                    //els[i].setAttribute("class","c");
                }
            }
        }
        //console.log(document.getElementById('image').getElementsByTagName('svg')[0]);
    function drawBigRect(pos,labal){
        var color=createColor();
        var width = pos[1][0]-pos[0][0]+10;
        var height=pos[1][1]-pos[0][1]+10;
        return '<rect x="'+pos[0][0]+'" y="'+pos[0][1]+'" width="'+width+'" height="'+height+'" stroke-width="0px" stroke="black" class="b" fill="'+color+'"/>'   
    }
    function createColor(){
        var rand = Math.random();
        while(rand<0.1){
            rand = Math.random();
        }
        return '#'+(rand*0xFFFFFF<<0).toString(16);
    }
    function compare(pos,cords){
        if(pos[0][0]>cords[0])
            pos[0][0]=cords[0];
        if(pos[0][1]>cords[1])
            pos[0][1]=cords[1];
        if(pos[1][0]<cords[0])
            pos[1][0]=cords[0];
        if(pos[1][1]<cords[1])
            pos[1][1]=cords[1];
        return pos;
        
    }
    function compare2(pos,cords){
        if(pos[1][0]>=cords[0] && pos[1][1]>=cords[1]){
                //console.log("x"+cords);
            if(pos[0][0]<=cords[0] && pos[0][1]<=cords[1]){
                //console.log(cords);
                return true;    
            }
            else{return false;};
        }
        else{return false;}
    }
    function getPosition(self){
        return [Number(self.getAttribute("x")),Number(self.getAttribute("y"))]
    }
    function addEvents(type,list,event){
        for(var i=0;i<list.length;i++){
            var oneRect = list[i];
            if(oneRect.getAttribute("class")=="a")
                oneRect.addEventListener(type,event)
            else{
            //oneRect.addEventListener("mouseover",function(){ifClicked=0;})
            }
        }
    }
    
    function on(){
        //document.getElementById("navbar_settings").addEventListener("dblclick",function(el){console.log(this)});
        var width=500;
        var height=200;
        var el = document.getElementById('image').getElementsByTagName('svg')[0];
        var elems="";
        for(var i=0;i<width/10;i++){
            for(var j=0;j<height/10;j++){
        //oneElem=array.points[i];
            elems+=defPoint(10*i,10*j);
            //makePoint(oneElem);
            }
        }
    //console.log('elems',elems);
    el.innerHTML+=elems;
        el.setAttribute("viewBox", '0 0 '+width+" "+height+'');
        el.setAttribute("width", width +'px');
            el.setAttribute("height",height+ "px");
        console.log(el);
        var x = el.getElementsByTagName("rect");
        addEvents("mouseover",x,function(){draw(this)});
    }
function clear(list){
    for(var i=0;i<list.length;i++){
        var oneRect = list[i];
        oneRect.setAttribute("fill","transparent");
    }
}
function draw(self){
    if(ifClicked==1)
        self.setAttribute("fill","purple");
        //self.style.fill = "purple";
    
}
function defPoint(i,j) {
    return '<rect x="'+i+'" y="'+j+'" width="10" height="10" stroke-width="0px" stroke="black" class="a" fill="transparent"/>'
    //return '<circle cx="0" cy="0" r="0" stroke-width="0.5px" stroke="black"  fill="red" />';
}
    
</script>
    <body onload="on()" class="body">

 

<ul class="navigation navDisplay navSize" >
  <li><a id="navbar_home" href="#home">Home</a></li>
  <li><a id="navbar_substitution" href="#changes">Zastępstwa</a></li>
  <li><a id="navbar_settings" href="#settings">Ustawienia</a></li>
  <li style="float:right"> <p id="navbar_photo" href="#about"><img id="personPictureVer" src=""/></p></li>
</ul>
<ul class="drop dropDisplay">
    <li >
     <a href="javascript:void(0)" >Menu</a>
     <div class="dropdown-content">
       <a id="navbar_homeD" href="#home">Home</a>
       <a id="navbar_substitutionD" href="#changes">Zastępstwa</a>
       <a id="navbar_settingsD" href="#settings">Ustawienia</a>
       <p id="navbar_photoD" href="#about"><img id="personPictureHor" src=""/></p>
     </div>
    </li>
</ul>
	<div id="msgArea"></div>
	<div class="flex-container nowrap mainContentSize" id="mainContent" >
        <div class="" id="substitutionList"   >
            <div  class="item-size  boxed-group" id="elementsContent">
                    <h3>Zastępstwa</h3>
                    <div class="boxed-group-inner" style="padding:0px; ">
                        <div>Wybierz dzień</div>
                        <div class="chooseDay" style="border-bottom:1px solid black;">
                            <ul>
                                <li class="btn" id="todayBtn" >Control</li>
                                <li class="btn" id="tommorowBtn"  >MoveTo</li>
                        <!--        <li id="chooseBtn" onclick="">choose</li> --> 
                            </ul>
                        </div>
                         <div id="forDay">
                            miejsce na nazwę
                        </div>
                         
                        <div class="scrollableList" id='elementsList'>
                         <div class="boxed-group-section first" id="changesContainer">
                     
                            
                    </div>
                            
                            </div>
    <p>17 czer</p>
  <div id="image"><svg ></svg></div>
                    </div>
                </div>
            
        </div>
        </div>
	<ul class="navigation navSize">
		<li>
			<a href="/privacy.html">Prywatność</a>
		</li>
		<li>
			<a href="/tos.html">Warunki</a>
		</li>
		<li style="float: right">
			<a href="https://github.com/szarp/substitutions" rel="noopener" target="_blank" style="padding: 10px; padding-top: 12px"><img alt="GitHub" src="/img/GitHub-Mark-32px.png" type="image/png" width="26px" height="26px"></img></a>
		</li>
	</ul>
    </body>
</html>
